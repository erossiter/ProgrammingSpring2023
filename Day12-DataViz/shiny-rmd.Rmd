---
title: "Interactive Shiny App"
output: 
  html_document: 
    runtime: shiny
---


This is an interactive Shiny app that allows you to explore a dataset.

Because we put `runtime: shiny` in the YAML it will compile as a shiny app!

```{r}
library(shiny)
library(ggplot2)
data(mtcars)

# Define UI
ui <- fluidPage(
  titlePanel("Interactive Shiny App"),
  sidebarLayout(
    sidebarPanel(
      selectInput("var", "Variable:", choices = colnames(mtcars), selected = "mpg"),
      sliderInput("bins", "Number of bins:", min = 5, max = 50, value = 30)
    ),
    mainPanel(
      plotOutput("plot")
    )
  )
)

# Define server logic
server <- function(input, output) {
  #render the histogram based on user inputs
  output$plot <- renderPlot({
    ggplot(mtcars, aes(x = get(input$var))) + 
      geom_histogram(binwidth = diff(range(mtcars[[input$var]])) / input$bins)
  })
}

# Run the app
shinyApp(ui = ui, server = server)
```